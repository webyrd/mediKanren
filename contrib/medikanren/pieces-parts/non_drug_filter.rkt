#lang racket
(require
  "../../../medikanren/pieces-parts/query.rkt")

;; define a number of helper functions for the function drug-info-for-curie
(define curie-to-anything
  (lambda (curie predicate*)
    ;;(printf "starting curie-to-anything with curie ~s and preds ~s\n" curie predicate*)
    (let ((val (query/graph
                ( ;; concepts
                 (X curie)
                 (T #f))
                ;; edges
                ((X->T predicate*))
                ;; paths      
                (X X->T T))))
      ;;(printf "finished curie-to-anything with curie ~s and preds ~s\n" curie predicate*)
      val)))

(define curie-to-tradenames
  (lambda (curie)
    (curie-to-anything curie '("has_tradename")))) 

(define curie-to-clinical-trials
  (lambda (curie)
    (curie-to-anything curie '("clinically_tested_terminated_phase_2"
                               "clinically_tested_approved_unknown_phase"
                               "clinically_tested_terminated_phase_2"
                               "clinically_tested_terminated_phase_3"
                               "clinically_tested_terminated_phase_2_or_phase_3"
                               "clinically_tested_withdrawn_phase_3"
                               "clinically_tested_withdrawn_phase_2_or_phase_3"
                               "clinically_tested_withdrawn_phase_2"
                               "clinically_tested_suspended_phase_2"
                               "clinically_tested_suspended_phase_3"
                               "clinically_tested_suspended_phase_2_or_phase_3"))))

(define curie-to-indicated_for
  (lambda (curie)
    (curie-to-anything curie '("indicated_for"))))

(define curie-to-contraindicated_for
  (lambda (curie)
    (curie-to-anything curie '("contraindicated_for"))))

(define drug-info-for-curie
  (lambda (curie)
    ; (printf "*** starting drug-info-for-curie ~s\n" curie)
    (map
     (lambda (l)
       (match l
         [`(,name . ,q)
          ; (printf "*** calculating curie-synonyms/names list for curie ~s\n" curie)
          (let ((ls (map curie-synonyms/names (curies/query q 'T))))
            ; (printf "*** calculated curie-synonyms/names list for curie ~s\n" curie)
            ; (printf "*** ls length = ~s\n" (apply + (map length ls)))
            (cons name ls))]))
     (list 
      (cons 'tradenames (curie-to-tradenames curie))
      (cons 'clinical-trials (curie-to-clinical-trials curie))
      (cons 'indicated_for (curie-to-indicated_for curie))
      (cons 'contraindicated_for (curie-to-contraindicated_for curie))))))




;; List of chemicals:
;; These chemicals are the results of queries to up or down-regulate a number of genes of interest
;; based on the CHAMP1 RNA sequencing data.


(define strategy1_chemicals
  '("CHEBI:28119"
  "CHEBI:16469"
  "CHEBI:37537"
  "CHEBI:41879"
  "CHEBI:17026"
  "CHEBI:6541"
  "CHEBI:4903"
  "CHEBI:33216"
  "CHEBI:9168"
  "CHEBI:41774"
  "CHEBI:65329"
  "CHEBI:17347"
  "CHEMBL:CHEMBL460433"
  "CHEBI:17747"
  "CHEBI:49662"
  "CHEBI:22984"
  "CHEBI:4031"
  "CHEBI:27584"
  "CHEBI:16243"
  "CHEBI:9130"
  "CHEBI:78543"
  "CHEBI:15365"
  "CHEMBL:CHEMBL62381"
  "CHEBI:52717"
  "CHEBI:175901"
  "CHEBI:16113"
  "CHEBI:29865"
  "CHEBI:28748"
  "CHEBI:5132"
  "CHEBI:44423"
  "CHEBI:45713"
  "CHEBI:15738"
  "CHEBI:16356"
  "CHEBI:77986"
  "CHEBI:3766"
  "CHEBI:17489"
  "CHEBI:8899"
  "CHEBI:15355"
  "CHEBI:3962"
  "CHEBI:28088"
  "CHEBI:76004"
  "CHEBI:27656"
  "CHEBI:77006"
  "CHEMBL:CHEMBL504"
  "CHEBI:8863"
  "CHEBI:9150"
  "CHEBI:31401"
  "CHEBI:16330"
  "CHEBI:44296"
  "CHEBI:15930"
  "CHEBI:17609"
  "CHEBI:92413"
  "CHEBI:47808"
  "CHEMBL.COMPOUND:CHEMBL3545133"
  "CHEMBL.COMPOUND:CHEMBL2109588"
  "CHEBI:517248"
  "CHEBI:28364"
  "CHEBI:9786"
  "CHEBI:3237"
  "CHEMBL:CHEMBL1372588"
  "CHEBI:135742"
  "CHEBI:9241"
  "CHEBI:6920"
  "CHEMBL:CHEMBL305576"
  "CHEBI:17712"
  "CHEBI:5759"
  "CHEBI:34892"
  "CHEBI:15960"
  "CHEBI:49040"
  "GTPI:5965"
  "CHEBI:8198"
  "CHEBI:34935"
  "CHEBI:52289"
  "CHEBI:49668"
  "CHEBI:34888"
  "CHEBI:135736"
  "CHEBI:138000"
  "CHEBI:28940"
  "CHEBI:29678"
  "CHEBI:2666"
  "CHEBI:35053"
  "CHEMBL.COMPOUND:CHEMBL3707348"
  "CHEBI:3763"
  "CHEBI:50114"
  "CHEMBL.COMPOUND:CHEMBL3545396"
  "CHEBI:16412"
  "CHEBI:88522"
  "CHEBI:50694"
  "CHEMBL:CHEMBL1903674"
  "CHEBI:78373"
  "CHEBI:28694"
  "CHEBI:17578"
  "CHEBI:30768"
  "CHEBI:76612"
  "CHEBI:338412"
  "CHEBI:17823"
  "CHEMBL:CHEMBL1371200"
  "CHEBI:30740"
  "CHEBI:107643"
  "CHEBI:27385"
  "CHEBI:15756"
  "CHEBI:135949"
  "CHEBI:15367"
  "CHEBI:63954"
  "GTPI:8492"
  "CHEBI:137113"
  "CHEBI:47495"
  "CHEBI:28499"
  "CHEBI:135735"
  "CHEBI:566274"
  "CHEBI:28112"
  "CHEBI:76003"
  "CHEBI:3655"
  "CHEMBL:CHEMBL1221984"
  "CHEMBL.COMPOUND:CHEMBL545315"
  "CHEBI:49960"
  "CHEMBL:CHEMBL1644699"
  "CHEBI:28842"
  "CHEBI:65310"
  "CHEBI:8081"
  "CHEMBL:CHEMBL8823"
  "CHEMBL:CHEMBL1565107"
  "CHEBI:30563"
  "CHEBI:91452"
  "CHEBI:4659"
  "CHEBI:8062"
  "CHEBI:16698"
  "CHEBI:18388"
  "CHEBI:28790"
  "CHEMBL.COMPOUND:CHEMBL2105719"
  "CHEBI:92843"
  "CHEBI:18243"
  "CHEBI:51450"
  "CHEBI:90695"
  "CHEBI:7590"
  "CHEMBL.COMPOUND:CHEMBL499968"
  "CHEBI:40303"
  "CHEMBL.COMPOUND:CHEMBL3137331"
  "CHEMBL.COMPOUND:CHEMBL356359"
  "CHEBI:62825"
  "CHEBI:2611"
  "CHEBI:15553"
  "CHEBI:132853"
  "CHEBI:351346"
  "CHEBI:17234"
  "CHEBI:6402"
  "CHEBI:39462"
  "CHEBI:7465"
  "CHEBI:34662"
  "CHEMBL:CHEMBL2146125"
  "CHEBI:31746"
  "CHEBI:8382"
  "CHEBI:18291"
  "CHEBI:18152"
  "CHEBI:95341"
  "CHEBI:35456"
  "CHEBI:18185"
  "CHEBI:3385"
  "CHEBI:6801"
  "CHEBI:34076"
  "CHEBI:6715"
  "CHEBI:7735"
  "CHEBI:45307"
  "CHEBI:46024"
  "CHEMBL:CHEMBL1981220"
  "CHEBI:66917"
  "CHEBI:556075"
  "CHEBI:27363"
  "CHEBI:15368"
  "CHEBI:83732"
  "CHEMBL.COMPOUND:CHEMBL1645462"
  "CHEBI:4305"
  "CHEBI:48045"
  "CHEMBL:CHEMBL190083"
  "CHEBI:65347"
  "CHEBI:15343"
  "CHEBI:86194"
  "CHEBI:15940"
  "CHEBI:38927"
  "CHEBI:31561"
  "CHEBI:6958"
  "CHEBI:90939"
  "CHEBI:32061"
  "CHEBI:6842"
  "CHEBI:6413"
  "CHEMBL:CHEMBL7463"
  "CHEBI:76607"
  "CHEMBL.COMPOUND:CHEMBL2103884"
  "CHEBI:35696"
  "CHEMBL.COMPOUND:CHEMBL1709719"
  "CHEBI:90948"
  "CHEBI:4046"
  "CHEBI:24814"
  "CHEMBL.COMPOUND:CHEMBL587723"
  "CHEBI:3084"
  "CHEBI:34269"
  "CHEBI:75253"
  "CHEBI:61400"
  "CHEBI:86345"
  "CHEBI:34873"
  "CHEBI:132268"
  "GTPI:8145"
  "CHEBI:43616"
  "CHEBI:135590"
  "CHEBI:15891"
  "CHEMBL:CHEMBL1977579"
  "CHEBI:50859"
  "CHEBI:9635"
  "CHEBI:101278"
  "CHEBI:45652"
  "CHEBI:3752"
  "CHEBI:3175"
  "CHEBI:44445"
  "CHEBI:28680"
  "CHEBI:39548"
  "CHEMBL.COMPOUND:CHEMBL3545154"
  "CHEBI:9908"
  "CHEBI:92890"
  "CHEBI:18145"
  "CHEBI:134301"
  "CHEMBL:CHEMBL499968"
  "CHEBI:69581"
  "CHEBI:39867"
  "CHEBI:17997"
  "CHEBI:17833"
  "CHEBI:15843"
  "CHEBI:45863"
  "CHEBI:16118"
  "CHEBI:61399"
  "CHEBI:27638"
  "CHEBI:28527"
  "CHEBI:7565"
  "CHEBI:61390"
  "CHEBI:61057"
  "CHEMBL:CHEMBL1201288"
  "CHEBI:2814"
  "CHEBI:91370"
  "CHEBI:32020"
  "CHEBI:8633"
  "CHEMBL:CHEMBL378104"
  "CHEBI:4460"
  "CHEBI:67272"
  "CHEBI:3440"
  "CHEBI:17241"
  "CHEBI:4042"
  "CHEBI:23359"))
                                          
  
(define strategy2_chemicals
  '("CHEBI:39867"
    "CHEBI:46024"
    "CHEBI:2666"
    "CHEBI:4031"
    "CHEBI:9150"
    "CHEBI:31252"
    "CHEBI:37537"
    "CHEBI:41879"
    "CHEBI:33216"
    "CHEBI:16469"
    "CHEBI:44915"
    "CHEBI:2504"
    "CHEBI:42944"
    "CHEBI:34714"
    "CHEBI:32315"
    "CHEBI:16069"
    "CHEBI:76591"
    "CHEBI:16330"
    "CHEBI:16243"
    "CHEBI:6908"
    "CHEBI:17609"
    "CHEBI:17941"
    "CHEBI:9130"
    "CHEBI:28741"
    "CHEMBL:CHEMBL455560"
    "CHEBI:6762"
    "CHEBI:24852"
    "CHEBI:7575"
    "CHEBI:27827"
    "CHEBI:82160"
    "CHEBI:8461"
    "CHEBI:135742"
    "CHEBI:63681"
    "CHEBI:15864"
    "CHEBI:6920"
    "CHEBI:53188"
    "CHEBI:32061"
    "CHEBI:92811"
    "CHEBI:81297"
    "CHEBI:38845"
    "CHEBI:251412"
    "CHEBI:15960"
    "CHEBI:609247"
    "CHEBI:47499"
    "CHEBI:31404"
    "CHEBI:47426"
    "CHEMBL:CHEMBL2002549"
    "CHEMBL:CHEMBL2140710"
    "GTPI:4589"
    "CHEBI:27919"
    "CHEBI:24814"
    "CHEBI:18145"
    "CHEBI:8062"
    "CHEMBL:CHEMBL1929421"
    "CHEBI:30114"
    "CHEBI:29150"
    "CHEMBL.COMPOUND:CHEMBL215645"
    "CHEBI:35622"
    "CHEBI:135935"
    "CHEBI:134884"
    "CHEBI:7459"
    "CHEBI:140422"
    "CHEBI:7071"
    "CHEBI:16412"
    "CHEBI:8107"
    "CHEBI:28216"
    "CHEMBL:CHEMBL33051"
    "CHEBI:135464"
    "CHEBI:8428"
    "CHEBI:41774"
    "CHEBI:28694"
    "CHEBI:36560"
    "CHEBI:59719"
    "CHEBI:338412"
    "CHEBI:45863"
    "CHEBI:15422"
    "CHEBI:45980"
    "CHEBI:49662"
    "CHEBI:32168"
    "CHEBI:135804"
    "CHEBI:2555"
    "CHEBI:68478"
    "CHEBI:2700"
    "CHEBI:16526"
    "CHEBI:17750"
    "CHEBI:28499"
    "CHEBI:36946"
    "CHEBI:141474"
    "CHEBI:4868"
    "CHEBI:28593"
    "CHEBI:34631"
    "CHEBI:143794"
    "CHEBI:7907"
    "CHEBI:8459"
    "CHEBI:27375"
    "CHEBI:15379"
    "CHEBI:8354"
    "CHEBI:72449"
    "CHEBI:2673"
    "CHEBI:34905"
    "CHEBI:33070"
    "CHEBI:28119"
    "CHEBI:18388"
    "CHEBI:17097"
    "CHEBI:45652"
    "CHEBI:52010"
    "CHEMBL:CHEMBL533841"
    "CHEBI:31425"
    "CHEBI:30563"
    "CHEMBL:CHEMBL2163791"
    "CHEBI:38093"
    "CHEBI:15354"
    "CHEBI:8874"
    "CHEMBL:CHEMBL1233973"
    "CHEBI:9741"
    "CHEBI:4948"
    "CHEBI:32988"
    "CHEBI:8024"
    "CHEBI:25944"
    "CHEBI:18049"
    "CHEBI:40303"
    "CHEMBL:CHEMBL26505"
    "CHEBI:87649"
    "CHEBI:3213"
    "CHEBI:8666"
    "CHEBI:82142"
    "CHEBI:31618"
    "CHEBI:34036"
    "CHEBI:39462"
    "CHEMBL:CHEMBL2272837"
    "CHEBI:53289"
    "CHEBI:9195"
    "CHEBI:38746"
    "CHEBI:6060"
    "CHEMBL:CHEMBL494887"
    "CHEBI:251408"
    "CHEBI:8382"
    "CHEBI:18152"
    "CHEBI:4791"
    "CHEBI:18009"
    "CHEBI:6931"
    "CHEBI:29865"
    "CHEBI:17051"
    "CHEBI:48883"
    "CHEBI:4806"
    "CHEBI:41934"
    "CHEBI:52741"
    "CHEBI:94848"
    "CHEBI:59514"
    "CHEBI:16716"
    "CHEMBL:CHEMBL444970"
    "CHEBI:553827"
    "CHEBI:17790"
    "CHEBI:37931"
    "CHEMBL:CHEMBL157912"
    "CHEBI:16737"
    "CHEBI:125392"
    "CHEBI:38624"
    "CHEBI:8102"
    "CHEBI:28794"
    "CHEBI:31622"
    "CHEBI:9711"
    "CHEBI:34761"
    "CHEBI:83533"
    "CHEBI:34611"
    "CHEBI:6801"
    "CHEBI:31561"
    "CHEBI:102166"
    "CHEBI:3390"
    "CHEBI:3374"
    "CHEBI:24536"
    "CHEMBL:CHEMBL284328"
    "CHEBI:30336"
    "CHEBI:4753"
    "CHEBI:27928"
    "CHEBI:31687"
    "CHEBI:5128"
    "CHEMBL:CHEMBL190083"
    "CHEBI:3766"
    "CHEBI:35038"
    "CHEBI:27953"
    "CHEBI:3387"
    "CHEBI:8230"
    "CHEBI:9449"
    "CHEBI:75701"
    "CHEBI:75372"
    "CHEBI:63716"
    "CHEMBL.COMPOUND:CHEMBL997"
    "CHEBI:28821"
    "CHEBI:247956"
    "CHEMBL:CHEMBL460433"
    "CHEBI:32223"
    "CHEBI:6758"
    "CHEBI:39447"
    "CHEBI:4527"
    "CHEBI:28374"
    "CHEBI:31302"
    "CHEBI:43616"
    "CHEBI:5706"
    "CHEBI:2791"
    "CHEBI:8665"
    "CHEBI:50859"
    "CHEBI:16881"
    "CHEBI:9635"
    "CHEMBL:CHEMBL26115"
    "CHEMBL:CHEMBL3181798"
    "CHEBI:8712"
    "CHEBI:3175"
    "CHEBI:313639"
    "CHEBI:7601"
    "CHEBI:27958"
    "CHEBI:32250"
    "CHEBI:135387"
    "CHEBI:7581"
    "CHEBI:31823"
    "CHEBI:6015"
    "CHEBI:49575"
    "CHEBI:7514"
    "CHEBI:63616"
    "CHEBI:22984"
    "CHEBI:135720"
    "CHEBI:41423"
    "CHEBI:125612"
    "CHEBI:28885"
    "CHEBI:28527"
    "CHEBI:17230"
    "CHEBI:4636"
    "CHEBI:15355"
    "CHEBI:3962"
    "CHEBI:34682"
    "CHEMBL:CHEMBL310934"
    "CHEBI:8774"
    "CHEBI:38721"
    "CHEBI:59849"
    "CHEBI:8025"
    "CHEBI:34690"
    "CHEBI:28088"
    "CHEBI:6601"
    "CHEMBL:CHEMBL430266"
    "CHEBI:48981"
    "CHEBI:15854"
    "CHEMBL.COMPOUND:CHEMBL1677"
    "CHEBI:23359"))


(define strategy3_chemicals '("CHEBI:39867"
  "CHEBI:16469"
  "CHEBI:17026"
  "CHEBI:65329"
  "CHEBI:41879"
  "CHEBI:45713"
  "CHEBI:6801"
  "CHEBI:49662"
  "CHEBI:16330"
  "CHEBI:16118"
  "CHEBI:16243"
  "CHEBI:6541"
  "CHEBI:15365"
  "CHEBI:137113"
  "CHEBI:15379"
  "CHEBI:9168"
  "CHEBI:3962"
  "CHEBI:16113"
  "CHEBI:9150"
  "CHEMBL:CHEMBL504"
  "CHEBI:8382"
  "CHEBI:17609"
  "CHEBI:44915"
  "CHEBI:18145"
  "CHEBI:78543"
  "CHEBI:4903"
  "CHEBI:52717"
  "CHEBI:47426"
  "CHEBI:41774"
  "CHEBI:30740"
  "CHEBI:2666"
  "CHEBI:8107"
  "CHEBI:17347"
  "CHEBI:50694"
  "CHEBI:28748"
  "CHEBI:15367"
  "CHEBI:18152"
  "CHEBI:39548"
  "CHEBI:18388"
  "CHEBI:28918"
  "CHEBI:28527"
  "CHEBI:7565"
  "CHEBI:16335"
  "CHEBI:175901"
  "CHEBI:28790"
  "CHEBI:8024"
  "CHEBI:40303"
  "CHEBI:3213"
  "CHEBI:15553"
  "CHEBI:42944"
  "CHEBI:6402"
  "CHEBI:44445"
  "CHEBI:39462"
  "CHEBI:15544"
  "CHEBI:61057"
  "CHEBI:2639"
  "CHEBI:68558"
  "CHEMBL:CHEMBL2146125"
  "CHEBI:6060"
  "CHEBI:15552"
  "CHEBI:17263"
  "CHEBI:18291"
  "CHEMBL:CHEMBL692"
  "CHEBI:9334"
  "CHEBI:17997"
  "CHEMBL:CHEMBL33051"
  "CHEBI:45951"
  "CHEBI:17941"
  "CHEBI:4917"
  "CHEBI:31252"
  "CHEBI:37931"
  "CHEBI:7735"
  "CHEBI:4806"
  "CHEBI:15864"
  "CHEBI:42191"
  "CHEBI:5132"
  "CHEBI:17230"
  "CHEBI:94848"
  "CHEBI:135742"
  "CHEBI:9241"
  "CHEBI:18332"
  "CHEBI:44423"
  "CHEBI:17790"
  "CHEBI:31547"
  "CHEMBL:CHEMBL117649"
  "CHEBI:34892"
  "CHEBI:49040"
  "CHEBI:47499"
  "CHEBI:27584"
  "CHEBI:125392"
  "CHEBI:9667"
  "CHEBI:28794"
  "CHEBI:3423"
  "CHEBI:15940"
  "CHEBI:41423"
  "CHEBI:8062"
  "CHEBI:15854"
  "CHEBI:16898"
  "CHEBI:3390"
  "CHEBI:3374"
  "CHEBI:24536"
  "CHEBI:76004"
  "CHEBI:7459"
  "CHEBI:16881"
  "CHEBI:8459"
  "CHEBI:7071"
  "CHEBI:16412"
  "CHEBI:2038"
  "CHEMBL:CHEMBL41631"
  "CHEBI:3766"
  "CHEBI:28593"
  "CHEBI:27953"
  "CHEBI:3387"
  "CHEBI:46195"
  "CHEMBL:CHEMBL264373"
  "CHEBI:30768"
  "CHEBI:45980"
  "CHEBI:28821"
  "CHEBI:61033"
  "CHEBI:37941"
  "CHEBI:17823"
  "CHEBI:63716"
  "CHEBI:3440"
  "CHEBI:32020"
  "CHEBI:135949"
  "CHEBI:15422"
  "CHEBI:9588"
  "CHEBI:16526"
  "CHEBI:17750"
  "CHEBI:78741"
  "CHEBI:3286"
  "CHEBI:8665"
  "CHEBI:18295"
  "CHEBI:101278"
  "CHEBI:566274"
  "CHEBI:68478"
  "CHEBI:8354"
  "CHEBI:7907"
  "CHEBI:16240"
  "CHEBI:9908"
  "CHEBI:9139"
  "CHEBI:69581"
  "CHEBI:6762"
  "CHEBI:8899"
  "CHEBI:7514"
  "CHEBI:63616"
  "CHEBI:45652"
  "CHEBI:27958"
  "CHEBI:86345"
  "CHEBI:49575"
  "CHEBI:4659"
  "CHEBI:15355"
  "CHEMBL:CHEMBL1201288"
  "CHEBI:15354"
  "CHEBI:76607"
  "CHEBI:18243"
  "CHEBI:8774"
  "CHEBI:2700"
  "CHEBI:50730"
  "CHEBI:29150"
  "CHEMBL:CHEMBL62381"
  "CHEBI:135804"
  "CHEBI:313639"
  "CHEBI:17303"
  "CHEBI:4636"
  "CHEBI:28364"
  "CHEBI:8378"
  "CHEBI:119915"
  "CHEBI:9130"))



;; From the list of chemicals, extract the non-drugs members with drugs are defined
;; as having either tradenames, clinical trials, indicated for and contraindicated for predicates
;; Chemicals that don't have any of these predicates are defined as non-drugs.
;; They could be supplements, which are likely to be safe, chemicals that are synthesized in chemical labs
;; to be used in several laboratory assays (these are unsafe until proven otherwise)
;; They could be investigational compounds that are also unsafe until proven otherwise.
;; They could be endogenous substances that are naturally produced in the human body by cells, DNA, RNA
;; but for some reason they are not being tested by FDA to be approved as therapies.
;; For non-drugs categories, unfortunately, I haven't found a mediKanren's way to group them into these different
;; groups so I'll do this categorization manually.

(define strategy1-non-drugs (filter
                             (lambda (x)
                               (equal? (drug-info-for-curie x)
                                       (list '(tradenames) '(clinical-trials) '(indicated_for) '(contraindicated_for))))
                             strategy1_chemicals))
(define strategy2-non-drugs (filter
                             (lambda (x)
                               (equal? (drug-info-for-curie x)
                                       (list '(tradenames) '(clinical-trials) '(indicated_for) '(contraindicated_for))))
                             strategy2_chemicals))

(define strategy3-non-drugs (filter
                             (lambda (x)
                               (equal? (drug-info-for-curie x)
                                       (list '(tradenames) '(clinical-trials) '(indicated_for) '(contraindicated_for))))
                             strategy3_chemicals))

(define strategy1-non-drugs-names (map car (map curie-synonyms/names strategy1-non-drugs)))
(define strategy2-non-drugs-names (map car (map curie-synonyms/names strategy2-non-drugs)))
(define strategy3-non-drugs-names (map car (map curie-synonyms/names strategy3-non-drugs)))

;; For the drugs, we need to assess if they have a lot of side effects
;; First, extract drug members:
(define strategy1-drugs (filter
 (lambda (x)
   (not (equal? (drug-info-for-curie x)
                (list '(tradenames) '(clinical-trials) '(indicated_for) '(contraindicated_for)))))
 strategy1_chemicals))

(define strategy2-drugs (filter
 (lambda (x)
   (not (equal? (drug-info-for-curie x)
                (list '(tradenames) '(clinical-trials) '(indicated_for) '(contraindicated_for)))))
 strategy2_chemicals))

(define strategy3-drugs (filter
 (lambda (x)
   (not (equal? (drug-info-for-curie x)
                (list '(tradenames) '(clinical-trials) '(indicated_for) '(contraindicated_for)))))
 strategy3_chemicals))

;; Take a look at their names:
(define strategy1-drugs-names (map car (map curie-synonyms/names strategy1-drugs)))
(define strategy2-drugs-names (map car (map curie-synonyms/names strategy2-drugs)))
(define strategy3-drugs-names (map car (map curie-synonyms/names strategy3-drugs)))

;; Helper functions:
(define side-effect-preds (list "causes"
                                "contributes_to"
                                "contraindicated_for"))


(define (sort-assoc lst)
  (sort lst
   >
   #:key (lambda (x) (length (cdr x)))))

(define ((edge/db? db) e) (eq? db (car e)))


;; sort-side-effects takes a list of drug-curies and sort them in descending order the number of side effects
;; This results aren't that useful for drug prioritizations, however. This is due to the biased in our knowledge graphs
;; because not all drugs have the same information density about their properties. Therefore, sorting drugs
;; by their side-effects accidentally sorting drugs by how much information/knowledge and data we have about the
;; particular drugs. This is not that useful in practice.
(define (sort-side-effects drug-curies)
  (sort-assoc
   (map
    (lambda (d)
      (define qdrug (time (query/graph
                           ((X d)
                            (O #f))
                           ((X->O side-effect-preds (edge/db? 'rtx2)))
                           (X X->O O))))
      (cons (assoc d (curie-synonyms/names d))
            (map (lambda (s) (assoc s (curie-synonyms/names s))) (curies/query qdrug 'O))))
     drug-curies)))

(define sort-strategy1-drugs-by-side-effects (sort-side-effects strategy1-drugs))